# R : 오픈소스, 시스템데이터 저장방식, 모든 OS에서 가능, S언어 기반, 객체지향&함수형 언어

- NA는 하나의 공간을 차지하는 결측값, NULL은 공간을 차지하지 않는 존재하지 않는 값을 의미
- 나눗셈의 몫 %/%, 나눗셈의 나머지 %%..
- 거듭제곱 ^, \*\*
- 자연상수의 거듭제곱 exp()
- R은 파이썬, 자바 등과 달리 시작 인덱스값이 0이 아닌 1이다...

# R오답

- 행렬에 저장되는 모든 데이터 타입은 같아야 한다. 숫자 행렬에 문자가 추가되는 경우 숫자 행렬의 모든 숫자들이 문자타입으로 변경되면서 문자가 추가된다.
  - 벡터(1차원), 행렬(2차원), 배열(3차원) <- 벡터기반으로, 모든 데이터 타입 같아야 함.
    - 리스트, 데이터프레임 <- 다른 타입의 데이터 저장 가능
- 벡터에 결측값(NA,NaN)가 존재하는 경우 평균값을 계산할 수 없다. 결측값을 무시하고 평균을 구하기 위해서는 mean(data, na.rm=T)를 사용한다.

```R
x<-c(1,2,NA,6)
mean(x) # NA가 나옴, NaN일시 NaN이 나옴.
x<-c(1,2,NULL,6)
mean(x) # 3이나옴, NULL은 공간을 차지하지 않는 존재하지 않는 값이므로, (1+2+6)/3 = 3
```

- rbind와 cbind는 두 벡터의 결합으로 행렬(matrix)를 반환한다 r:행으로, c:열로
- xlim은 x축의 범위를 제한하는 매개변수지만 콜론:가 아닌 콤마,로 표현한다.
  - xlim(1,10)

# 데이터마트

- 데이터 전처리는 데이터 정제, 분석 변수 처리를 포함한 개념

  - 데이터 정제: 결측값, 이상값 처리
  - 분석 변수 처리: 변수 선택, 차원 축소, 파생변수 생성, 변수 변환, 클래스 불균형 처리 등

- 요약변수: 원래의 데이터로부터 기본적인 통계 자료를 추출한 변수(예시: 총 합계, 평균, 횟수 등)로 '재활용성이 높다'.
  - 기간 별 구매 금액, 횟수, 여부 등?, 트렌드, 위클리 쇼퍼
- 파생변수: 범용으로 활용되는 기본적인 통계 자료가 아닌, 특정한 목적을 갖고 조건을 만족하는 변수들을 새롭게 생성한 것을 의미
  - 뭔가 주로~한 변수 이러면 요약임, 주 구매 상품~, 주로 선호하는~
    - 따라서 파생변수에는 목적에 따른 특정한 의미가 부여되며, 주관적일 수 있으므로 논리적 타당성을 갖춰야 함.

## sqldf 패키지

- sqldf() 괄호안에서 sqld 쿼리문을 작성해서 데이터프레임 다룰 수 있음.

## plyr패키지

```R
ddply(score, "class", summarise, math_avg=mean(math), eng_avg=mean(english))
  - summarise: 보통 결과 요약이 필요할 때
ddply(score, "class", transform, math_avg=mean(math), eng_avg=mean(english))
  - transform: 계산값을 열로 추가하고 싶을 때
# 기준이 되는 변수를 2개 이상 묶어서 사용 가능
ddply(data, c("year","month"), summarise, value_avg=mean(value))
# 원하는 임의의 함수를 작성해서 사용 가능
ddply(data, c("year","month"), function(x){
    value_avg = mean(x$value)
    value_sd = sd(x$value)
    data.frame(ave_sd=value_avg/value_sd)
})
```

- summarise는 데이터 요약, transform은 기존 데이터에 추가
- abply에서, a는 입력데이터구조, b는 출력데이터구조.
- 예를 들어, adply하면, array를 입력하여 data.frame을 출력.

# 변수 구간화 방법

1. 비닝(Binning): 연속형 변수 -> 범주형 변수 위해 50개 이하 구간에 동일한 수의 데이터 할당, 의미 파악하며 구간 축소
2. 의사결정나무: 모형을 통해 연속형 변수-> 범주형 변수

# 탐색적 데이터 분석 EDA

- EDA란 데이터를 이해하고 의미있는 관계를 찾아내기 위해 데이터의 통곗값과 분포 등을 시각화하고 분석하는 것을 말한다.
  - EDA의 4가지 주제(4R):
    - 저항성의 강조(Resistance), 잔차 계산(Residual), 자료변수의 재표현(Re-expression), 그래프 통한 현시성(Representation)

## 결측값

- 존재하지 않는 데이터 NA, NULL, 공백, -1 등
- 결측값 대치 방법 (완 평 단 회 + 다중)

1. 단순(완전) 대치법 : 결측값이 존재하는 데이터를 삭제
   - complete.cases함수 사용
2. 평균 대치법
   - 비조건부 평균 대치법 : 관측데이터의 평균 혹은 중앙값으로 대치
     - centralImputation 함수 사용
   - 조건부 평균 대치법 : 실제 값들을 회귀분석하여 대치
3. 단순 확률 대치법 : 추정량 표준 오차의 과소 추정 문제 해결, 확률적으로 선택하여 대치 -> KNN방법
   - knnImputation 함수 사용
   - Hot-Deck(현재 데이터 셋에서 비슷한 성향으로 대체)
   - Cold-Deck(유사한 외부 출처에서 비슷한 성향으로 대체)
4. 다중 대치법 : 여러 번의 대치를 통해 n개의 임의 완전 자료를 만드는 방법, Amelia패키지 사용
   - 대치 > 분석 > 결합 3단계 (대 분 결)
   - iris_imp<-amelia 하고, iris_imp$imputation 이런식의 함수 사용

## 이상값

- 이상값 판정

1. ESD: 평균으로부터 3표준편차 만큼 떨어진 값을 이상값으로 인식
2. 사분위수: Q3-Q1인 사분범위(IQR)을 가지고, Q1 - 1.5 IQR보다 작은 값, Q3 + 1.5 IQR보다 큰 값을 이상값으로 간주한다.(boxplot의 아웃라이어)
3. 기하평균으로부터 2.5표준편차 떨어진 값을 이상값으로 인식

- Z-score, DBScan(밀도가 작은 부분을 이상값)

# 통계의 이해

- 두 변수가 독립이면 공분산=0
  - 그러나 공분산=0 이라고 두 변수가 반드시 독립은 아님.
- 왜도(skewness) = 0일 때 평균 = 중앙값 = 최빈값

## 표본추출 방법

1. 단순 무작위 추출법 : N개 모집단에서 n개 데이터 무작위 추출
2. 계통 추출법 : 모집단의 원소에 차례대로 번호 부여한 뒤, 일정한 간격을 두고 데이터를 추출, K개씩 n개의 구간 나눈 뒤, 첫 구간에서 임의로 하나 선택 후 K개씩 띄어서 추출, 비복원 추출임.
3. 층화 추출법 : 데이터를 여러 층으로 구분, 각 층에서 원하는 개수의 데이터 추출, 층 내 동질적, 층 간 이질적 (여자 50, 남자 50명)
   - 비례 층화 추출법: 각 계층 데이터 분포 비율과 동일하게 추출, 1학년 300, 2학년 400, 3학년 500명이라면, 3:4:5 비율로 추출
   - 불비례 층화 추출법: 분포 반영 없이 원하는 개수의 데이터 추출
4. 군집(집락) 추출법 : 데이터를 여러 군집으로 구분한 뒤 한 개 군집을 단순 무작위 추출. 군집 내 이질적, 군집 간 동질적

- 단순, 군집, 층화 추출법은 비복원/복원 여부를 결정해야 함, 계통 추출법은 비복원 추출(비계).

# 확률과 확률분포

## 확률 변수

1. 이산확률변수 - 이산확률분포 - 확률질량함수
   - 베르누이 분포 : 한 번에 시행을 할 때 성공과 실패로 나눌 수 있는 성공할 확률이 p인 분포
   - 이항 분포 : n번의 베르누이 시행에서 k번 성공할 확률의 분포
   - 기하 분포 : 성공확률이 p인 베르누이 시행에서 처음으로 성공이 나올 때 까지 k번 실패할 확률(즉, 처음 성공할 때 까지 n번 시행할 확률)
   - 다항 분포 : 이항 분포를 확장한 개념, n번의 시행에서 각 시행이 3개 이상의 결과를 가질 수 있는 확률
   - 포아송 분포 : 단위 시간 동안 발생할 수 있는 사건의 발생 횟수에 대한 확률분포
   * 초기하 분포: N개 중 비복원 n번 추출시 원하는 결과가 k번 나올 확률
   * 이산균등분포(주사위의 각 면이 나올 확률 모두 동일)
2. 연속확률변수 - 연속확률분포 - 확률밀도함수
   - 균일 분포
   - 정규분포: Z검정 활용
   - t-분포 (자유도 n-1), 표본이 30개보다 적은 집단
   - 카이제곱 분포 (자유도 n)
   - F 분포
   - 지수분포

- 중심극한정리(CLT): 표본 크기가 충분히 크면(30이상) 모집단의 분포에 상관없이 표본평균 분포가 정규분포를 이룸. (모집단 분포가 어떻게 생기든지, 찌그러지든지, 울퉁불퉁하던지..)

# 추정

## 점추정

- 점추정 조건 - 불 효 일 충
  - 불편의성: 추정량의 기댓값이 실제 모수와 같음(편향이 0)
  - 효율성: 분산이 작은 것이 더 효율적인 추정량
  - 일치성: 표본 크기 증가할수록 추정량이 모수에 가까워짐(일치함)
  - 충족성: 추정량이 모집단의 정보를 최대한 반영
- 모평균을 하나의 특정한 값으로 예측하는 것. 불편추정량은 표본평균이 대표적.
- 불편(unbiased)추정량: 모수 추정 값과 실제 모수 값 차이의 기댓값이 0으로, 어느 한 쪽으로 편향되지 않아 모수를 추정하기에 가장 이상적인 값.
  - 불편추정량 중 최소의 분산을 가진 추정량이 가장 좋은 추정량임.

## 구간추정

- 점추정을 보완, 모수가 특정 구간에 있을 것이라고 추정하는 것

# 가설검정

- 유의수준 (알파)
  - 귀무가설이 사실일 때, 이를 기각하는 확률
  - 제 1종 오류가 발생할 수 있는 최대의 확률
  - 통상적으로 0.05사용
- 유의확률 p-value
  - 귀무가설을 지지하는 정도로 검정통계량으로부터 얻는 값
  - 귀무가설이 참일 때, 현재 관측값보다 더 극단적인 값이 나올 확률

# 비모수 검정

- 모수 검정은 표본의 정규성이 확보되어야 함.
- 비모수 검정은 정규성 검정에서 정규분포를 따르지 않는다고 증명되거나, 정규분포임을 가정할 수 없는 경우에 사용. 독립성은 확보되어야 함.
- 부호검정, 윌콕슨 순위합검정, 만-휘트니 검정(독립표본), 크루스칼-왈리스 검정(ANOVA에대응), 런검정, 카이제곱 검정

# 기술통계

1. 중심 위치의 측도 : 평균, 중앙값, 최빈값
2. 산포의 측도 : 분산, 표준편차, 사분위수범위, 변동계수(CV: 표준편차/표본평균), 표준오차(SE: 표준편차/n제곱근)
3. 분포의 형태 : 첨도, 왜도

- 그래프를 통한 자료 정리
  - 범주형 : 막대그래프, 파이차트, 모자이크 플랏 등
  - 연속형 : 히스토그램, 줄기-잎 그림, box plot 등
    - 막대그래프는 막대 사이가 떨어져 있고 각 막대의 높이가 서로 다른 항목의 값을 비교하며 순서 상관x, 히스토그램은 막대가 붙어 있고 값들의 구간별 빈도나 밀도를 연속적으로 표현, 순서 상관 o.

# 기초통계

- 산점도: 두 변수간 선형관계, 함수관계, 이상값 존재 여부, 몇 개의 집단으로 구분되는지 확인 가능

## T 검정

1. 단일표본 t검정 : 하나의 모집단의 평균 값이 기준값과 다른지 검정
   - 양측 검정: ~이다, 아니다(==, !=)여부 검정
     - 대한민국 남성의 평균 키는 175이다
   - 단측 검정: ~보다 크다, 작다 (>, <)를 검정
     - 대한민국 여성의 평균 키는 160보다 크다
2. 독립표본 t검정 : 서로 다른 두 집단의 평균 차이를 검정
   - 양측 검정: ~이다, 아니다(==, !=)여부 검정
     - 남학생과 여학생의 수학 점수 평균이 다른가?
   - 단측 검정: ~보다 크다, 작다 (>, <)를 검정
     - A회사의 급여가 B회사의 급여보다 같거나 많다.
       - H0: A회사 급여 >= B회사 급여
3. 대응표본 t검정: 동일한 대상에 대하여 두 번 측정한 값 차이를 비교
   - 영어 학습 전 후 점수에 차이가 있는가?

- **대립가설(H₁)**에는 "같다(=)"를 포함시킬 수 없습니다.
- 왜냐하면 → **통계 검정에서는 "="(등호)**는 항상 귀무가설(H₀)에만 들어가야 하기 때문입니다.
- 즉, "같다, 같거나 작다, 같거나 크다" → 항상 H₀에만 씁니다.
- ✖ 반대로, 대립가설은 부등호만 사용합니다: ≠, <, > 중 하나.

## 분산분석(ANOVA)

- 분산분석은 세 개 이상의 모집단이 있을 때 여러 집단 간 평균을 비교하는 검정 방법
  - 독립변수: 범주형, 종속변수: 연속형
- 분산분석의 귀무가설은 항상 -> 'H0: 모든 집단 간 평균은 같다' 로 설정
  - 귀무가설을 기각할 경우에도, 어느 집단간 평균이 같고, 어느 집단간 평균이 얼마나 다른지를 알 수는 없다.
    - 따라서, 사후검정 방법으로, Scheffe, Tukey, Fisher`s LSD등의 방법을 사용한다.
- 분산분석을 수행하기 위해서는 아래의 세 가지 가정사항을 필요로 한다

1. 정규성 : 각 집단의 표본들은 정규분포를 따라야 한다
2. 등분산성 : 각 집단은 동일한 분산을 가져야 한다
3. 독립성 : 각 집단은 서로에게 영향을 주지 말아야 한다

- t검정에서도 필요함.(단 등분산성은 독립표본 t검정에서만 필요.)
- 정등독

### 일원분산분석

- 하나의 집단에 속하는 독립변수, 종속변수가 모두 한 개일 때 사용.
  - 연령대별(청소년, 성인, 노인) 유튜브 시청 시간의 차이가 있는가?

### 이원분산분석

- 일원분산분석에서, 독립변수의 수가 2개 이상일 때 사용.
  - 성별(남성, 여성), 연령별(청소년, 성인, 노인) 유튜브 시청 시간 차이가 있는가?
- 이원분산분석은 독립변수 간 교호작용이 있다고 판단될 때는 '반복이 있는 실험'을 하고, 교호작용이 없다고 판단될 때(두 독립변수 간 독립일 때)는 '반복이 없는 실험'을 한다.

### 다변량분산분석(MANOVA)

- 집단 간 평균차이를 검정할 때 종속변수가 2개 이상이면 사용.

## 교차분석

- 범주형 자료 간 관계를 알아보고자 할 때 사용
  - (지역) 별 (전자제품 브랜드) 선호도?
- 카이제곱 통계량 사용
- 적합도 검정, 독립성 검정, 동질성 검정에 사용됨.

### 적합도 검정

- 하나의 범주형 변수의 관측 분포가 이론적 분포와 일치하는지 검정
- 실험 결과 얻어진 관측값이 예상값과 일치하는지 여부를 검정
  - 관측값: 관측도수, 예상값: 기대도수 라고 부름.
    - 관측도수와 기대도수가 일치한다 -> 실제 분포와 예측 분포 간 차이가 없다.
- 'H0: 두 분포간 차이가 없다' 로 설정, 자유도는 n-1

### 독립성 검정

- 모집단이 두 변수에 의해 범주화됐을 때, 두 변수들 간 관계가 독립적인지 검정.
- 두 변수간 관계 유무만 나타낼 뿐, 관계의 강도를 나타내지는 않음.
  - 자유도는 (행의 수 - 1)(열의 수 - 1)

### 동질성 검정

- 관측값들이 정해진 범주 내에서 서로 비슷하게 나타나고 있는지를 검정(서로 다른 집단 간 분포가 동일한지)
- 두 집단의 분포가 동일한 모집단에서 추출된 것인지? -> 부모집단별로 요인에 대한 차이가 있는지를 검정.
- 계산과 자유도는 독립성 검정과 같다.

## 상관분석

- 두 변수 간 선형적 관계가 존재하는지 알아보는 분석, 상관계수를 활용한다. 상관계수는 -1~1 사이의 값.
- 상관관계가 있다고 무조건 인과관계가 있는 건 아니다. [중요]
- H0: 두 변수는 아무 상관관계가 없다.

1. 피어슨 상관분석(선형적 상관관계)

- 연속형변수, 선형관계 크기 측정 (-1~1)

2. 스피어만 상관분석(비선형적 상관관계)

- 스피어만 상관계수는 서열척도(순서형변수), 선형/비선형적 관계 나타냄 (1 or -1 ?)
  - 선형관계 아니더라도 1또는 -1이 될 수 있다.

## 분석방법 별 자유도, 귀무가설 정리

- 단일표본 t검정
  - n − 1
    - 표본 평균 = 기준값 (μ = μ₀)
- 독립표본 t검정
  - n₁ + n₂ − 2
    - 두 집단 평균이 같다 (μ₁ = μ₂)
- 대응표본 t검정
  - n − 1 (쌍의 수)
    - 두 시점/처리 전후의 평균이 같다 (μ차이 = 0)
- 일원분산분석(ANOVA) - 연속형 ~ 범주형 <- R에서, aov(pressure ~ age) 처럼, aov(종속변수~독립변수) 형태로 씀..
  - (집단수−1, 전체 표본수−집단수) = (SSR : k−1, SSE : N−k)
    - 모든 집단 평균이 같다 (μ₁ = μ₂ = … = μₖ)
- 교차분석 (카이제곱) - 범주형 ~ 범주형
  - 독립성, 동질성 검정: (행 개수 − 1) × (열 개수 − 1) <- 중요
    - 두 변수는 독립이다 (관계 없음)
- 상관분석 (피어슨) - 수치형 ~ 수치형
  - n − 2 -> 상관계수는 결국 회귀 직선의 기울기 검정과 동일한 개념입니다.
    - 상관계수 r = 0 (두 변수는 선형 상관이 없다)

# 회귀분석

- r summary 자유도 2 and 9 df -> 2+9=11=n-1이므로, n=11+1=12, 데이터 수=12
- 독립변수, 종속변수 간 인과관계

1. 단순회귀 : 1개의 독립변수
2. 다중회귀 : k개의 독립변수
3. 다항회귀 : 1개의 독립변수와 종속변수가 2차 함수 이상의 관계
4. 다중다항회귀 : k개의 독립변수와 종속변수가 2차 함수 이상의 관계
5. 비선형회귀 : 선형관계가 x (지수, 로그, 삼각)

## 회귀분석의 가정

1. 선형성 : 독립변수와 종속변수간 선형적이어야 한다. (다항회귀는 예외)
2. 독립성 : 잔차와 독립변수, 독립변수들 간 상관성 없이 독립이어야 함. (상관성이 있을 시, 다중공선성이라 하며 제거해야 함)
3. 등분산성 : 잔차들이 고르게 분포하고 있는가? 잔차의 중심에서 분산이 같아야 함.
4. 비상관성 : 잔차 끼리는 서로 상관이 없어야 함 (서로 영향이 없어야 함)
5. 정규성 : 잔차항이 정규분포 형태를 갖는 것을 의미. Q-Q plot에서 잔차가 오른쪽으로 상승하는 형태를 띄면 정규성을 만족한다고 함.
   - 히스토그램, Q-Q plot을 통해 시각적으로 확인 가능, 통계적으론, 샤피로, 앤더슨, 하르케-베라 등

- 예측값과 실제값의 차이 -> 모집단에선 '오차', 표본집단에선 '잔차'라고 함.

## 단순선형회귀분석

- 최소제곱법으로 회귀계수 추정.

1. SST: 총제곱합
   - 실제값과 평균값의 차이(편차 제곱합=총변동량)
2. SSE: 오차제곱합, 모델이 설명하지 못하는 부분
   - 실제값과 회귀식의 차이
3. SSR: 회귀제곱합, 모델이 설명하는 부분
   - 회귀식과 평균값의 차이

## 회귀모형의 통계적 유의성 검증 - F-검정 '회귀모형'

- 회귀모형의 귀무가설 : 'H0: 모든 회귀계수는 0이다'
  - F-검정은 분산의 차이를 확인할 때 사용하는데, 이 분산의 차이가 크다는 것은 회귀모형에서 회귀계수가 크다는 의미를 가짐.

## 회귀계수의 통계적 유의성 검증 - t-검정 '회귀계수'

- t-통계량은, 회귀계수를 표준오차로 나눈 값.
  - t-통계량이 크다 -> 표준오차가 작다 -> 회귀계수가 크다 -> 인과관계가 유의미하다.

## 회귀모형의 설명력 = 결정계수 R² (0 <= R² <= 1)

- 결정계수 R² = SSR/SST
- 수정된 결정계수 Adjusted R²: 독립변수가 증가함에 따라 증가하는 결정계수를 상쇄, 보완해줌. 보통 R²보다 작다.
  - R²과 Adjusted R²의 차이가 크다면, AIC나 BIC와 같은 벌점이나 다른 지표를 통해서 모델을 평가해야 한다.
    - R²과 Adjusted R²의 차이가 작더라도 독립변수간 독립성을 보장하진 않음.

## 다중선형회귀분석

- 독립변수 2개이상, 종속변수 하나
- 독립변수 간 다중공선성을 해결해야 함.
  - 분산팽창요인 VIF = 1/(1-R²) 가 4 이상이면 다중공선성이 있다고 판단. 10이상이면 심각

### 다중공선성 문제 해결법

1. 주성분분석 PCA : 공분산행렬(정방행렬) 사용, 정규화 필요
2. 스크리 산점도로 주성분 개수 선택
3. 선형판별분석 LDA : 지도학습임
4. 특잇값분해 SVD : m x n 임의의 행렬 가능, 정규화 없어도 가능
5. t-분포 확률적 임베딩 t-SNE

## 최적 회귀방정식

- 1개의 종속변수 y를 설명하기 위한 k개의 독립변수 후보들이 있을 때, 반응변수 y를 가장 잘 설명할 수 있는 회귀식을 찾는 것이 목표

### 최적 회귀방정식을 도출하기 위한 변수선택법

1. 부분집합법(임베디드 기법) : 라쏘, 릿지, 엘라스틱넷 등, C4.5?
2. 단계적 변수 선택법(래퍼 기법) : 전진 선택법, 후진 소거법, 단계별 선택법

### 벌점화 방식의 AIC, BIC

- 회귀 모형은 변수의 수가 증가할 수록 편향은 감소, 분산은 증가하는 경향이 있다. (=과적합 경향이 있다)

1. AIC: '변수 수' 만큼 패널티, AIC = -2LogL()+2k (k: 모수 개수)
2. BIC: 표본이 커질 때 부정확하다는 AIC의 단점 보완, -2LogL()+klog(n) (k: 모수 개수, n: 자료의 개수)
3. Mallow`s Cp: Cp값은 모든 변수가 다 포함될 때 p값과 같아진다. Cp값이 최소한 p보다는 작을 때 좋은 모델이다. p보다 크면 나쁜 모델

### 단계적 변수 선택법

1. 전진선택법: 영향 큰 변수부터 하나씩 추가
2. 후진소거법: 모든 독립변수를 포함하여, 영향이 적은 변수부터 하나씩 제거
3. 단계별 선택법: 전진+후진-> 추가, 제거할 때 예상되는 벌점값을 최소화하도록 하는 방법

# 고급 회귀분석

## 과적합 방지 - 정규화 선형회귀

1. 라쏘: 가중치들의 맨하탄 거리(절댓값의 합) 최소화
2. 릿지: 가중치들의 제곱합 최소화
3. 엘라스틱넷: 라쏘+릿지, 맨하탄 거리와 제곱합을 동시에 제약조건으로 가짐

## 일반화 선형 회귀 GLM - R에서 로지스틱 회귀 시 glm(~) 사용함!

- GLM은 Y의 분포를 직접 가정하기 때문에, 적절한 분포를 골라야 함
- GLM의 구성요소: 확률 요소, 선형 예측자, 연결 함수 - 확선연

1. 로지스틱 회귀: 종속변수가 범주형 변수(0과 1, 합격/불합격 등), Y의 분포 = 베르누이 분포
2. 포아송 회귀: 종속변수가 특정 시간동안 발생한 사건의 건수에 대한 도수자료, Y의 분포 = 포아송 분포
   - 최대 가능도 추정 MLE를 통해 모수를 추정

## 더빈 왓슨 검정 (2상관x, 더빈왓슨은 2상해)

- 오차항의 상관관계: 시계열 데이터는 연속적인 일련의 관측치들이 서로 상관되어 있는데, 즉 하나의 잔차항의 크기가 이웃하는 다른 잔차항의 크기와 서로 일정한 관련이 있고, 이를 자기상관성이라 한다. -> 잔차항 간 관련이 있는 것 = 자기 상관성
- 회귀분석에 있어서는 오차항이 서로 연관성이 없어야 한다 = 자기상관성이 없어야 한다 = 오차항의 공분산이 0이어야 한다 (비상관성)
- 자기상관성이 있는지 검사하는 것이 '더빈 왓슨 검정'
  - 2에 가까울수록 자기상관성이 없음. 0에 가깝다면 양의 상관관계, 4에 가깝다면 음의 상관관계가 있다고 판단. 특이하네..
- 자기상관성 - 더빈왓슨 - 2에 가까울수록 자기상관성 없음

## 회귀분석의 평가지표 : MAE, MSE, RMSE, MAPE 등..

## 중간 문제 정리

1. F-통계량의 자유도
   - 분자 자유도 (df₁): 설명변수(회귀분석)의 수 또는 집단 수 − 1(k-1)
   - 분모 자유도 (df₂): (전체 관측값 수 − 설명변수 수 − 1)(회귀분석), 또는 오차항 자유도(ANOVA에선 N−k)
     - 예를 들어, 단순 선형 회귀에서 데이터 수 n=9 일때, df1: 1, df2: (9-1)-1=7
       - ANOVA에서 집단 수 3개, 총 15개 데이터일 때, df1: 3-1=2, df2: 15-3=12 (N-k)

# 다변량 분석

## 다차원 척도법 MDS - stress척도

- 데이터 간 거리 정보의 근접성 보존 방식으로 차원 축소하여 시각화.
  - 계량적 MDS: 양적척도
  - 비계량적 MDS: 순서척도
- 데이터를 저차원 공간에 배열하는 시각화 기법
- 객체 간 근접성 시각화, 데이터 축소 목적, 유클리디안 거리 행렬 사용
- 다차원 척도법에선 stress 척도를 사용함. 0~1사이 값을 가지며, 낮을수록 적합도가 높다고 평가.
  - 보통 0.05 이내이면 적합도가 좋다고 평가, 0.15 이상이면 매우 나쁘다고 평가.

## 주성분분석 PCA

- 변수의 수 = 차원 수
- 군집분석 시 성능 높일 수 있음
- IoT 센서 데이터를 PCA후 스마트팩토리에 활용
- 주성분분석 시 선형변환이 필요함.

- 분산이 가장 큰 축을 찾아 새로운 변수로 만듦
- 계산 간단, 데이터 부족이나 정렬되지 않은 속성을 가진 데이터도 처리할 수 있음
- 고윳값이 평균 고윳값보다 '작은' 주성분을 '제거'하는 평균 고윳값 방법이 있음.

- 주성분분석은 전체 데이터의 70%이상을 설명할 수 있도록 선택한다(70~90%)
  - 누적 설명력인 Cumulative Proportion이 70%이상이 되면 중단
- Scree Plot: x축을 '주성분의 개수', y축을 '고윳값'으로 하는 그래프로, 그래프가 '수평'을 이루기 직전 단계를 주성분의 수로 선택
- biplot: 첫 번째 주성분과 두 번째 주성분을 축으로 하는 그래프 (그래프 해석 연습하기)

## 차원의 저주

- 불충분한 데이터 수에 어울리지 않는 고차원 데이터는 모델 성능에 부정적 결과를 가져온다.

# 시계열 분석

- 시계열 분석: 일정한 시간 간격으로 기록된 자료들에 대하여 특성을 파악하고 미래를 예측하는 분석(날씨, 주식 등 예측)
- 자기상관계수 개념이 중요
- 대부분의 시계열 자료는 비정상성 시계열 자료, 그러나 시계열 분석을 수행하려면 정상성 자료여야 함. 따라서 정상성 시계열 자료로 변환해야 함.
  - 정상성: 평균, 분산이 일정할 것, 공분산이 시차에만 의존하고, 시점에 의존하지 않을 것
    - 일정하지 않은 평균: 차분 통해 정상화 (차분: 현 시점 자료 값에서 전 시점 자료 값을 빼는 것)
    - 일정하지 않은 분산: 변환 통해 정상화, 자료값에 지수 또는 로그를 취해 변환
    - 공분산: t시점과 t-s시점의 공분산, t시점과 t+s시점의 공분산은 서로 같다. (공분산이 시점에 의존 x)

## 자기상관계수 ACF

- 시간의 흐름에 따른 두 시계열 확률변수 간 자기상관관계 변화. 일반적으로 시차가 증가하면 값이 감소함
- 시차가 있는 과거 값과 현재 값 사이의 상관관계 Yₜ와 Yₜ₋₃ (Yₜ ~ Yₜ₋₃)

## 부분자기상관계수 PACF

- 두 시계열 확률변수 간 다른 시점의 확률변수 영향력을 통제하고 상관관계만 보여주는 것, 일반적으로 특정 시점 이후 급격히 감소함.
- 중간 시차의 영향을 제거한, 특정 시차의 순수한 상관관계 Yₜ와 Yₜ₋₃ (only Yₜ , Yₜ₋₃)
  - e.g. 교회가 많을수록 범죄 발생률이 높다는 연구 -> 교회가 많을수록 인구수가 많다. 이때 인구라는 요인은 제외(통제)하고 오로지 교회와 범죄 발생률 둘 사이의 상관관계만을 고려할 때 PACF를 이용하는 것.
- ACF(3):
  - Yₜ와 Yₜ₋₃ 사이의 상관관계 (Yₜ₋₁, Yₜ₋₂ 영향도 포함됨)
- PACF(3):
  - Yₜ와 Yₜ₋₃ 둘의 직접적인 상관만 추출 (Yₜ₋₁, Yₜ₋₂ 제거 후)

## 시계열 분석 기법

1. 이동평균법: 일정 기간별로 자료를 묶어 평균을 구하는 방법
2. 지수평활법: 모든 시계열데이터 활용, 최근 데이터일수록 큰 가중치 부여, 오래된 데이터일수록 작은 가중치 부여

## 시계열 모형

1. 자기회귀(AR) 모형

- 이전 시점들의 자료값들에 의한 선형 결합
- t라는 시점에서의 값은 이전 시점(p)들 n개에 의해 설명될 수 있음을 의미
  - 적절한 n의 값 결정 위해 [부분자기상관함수] 사용, ACF는 빠르게 감소
  - 백색잡음: 공분산과 자기공분산이 모두 0인 시계열 자료(현재 시점이 이전 시점과의 상관관계가 없는)
    - 처음으로 파란선 안에 존재하는 시점 직전의 시점까지가 현재 시점에 영향을 미친다 판단 AR(1), 그러나 3지점에서 다시 파란선 밖에 존재, 4지점에서 다시 파란선 안에 존재(자기상관이 낮음), 3지점까지가 현재 시점에 영향을 미친다 판단, AR(3)모형 사용 가능하다 판단
      - 가능한 후보 모형은 AR(1), AR(3)이다 <- 이거 연습하기

2. 이동평균(MA) 모형

- 이전 시점의 백색 잡음들의 선형 결합 <- 항상 정상성을 만족함
  - 적절한 n의 값 결정 위해 [자기상관함수] 사용, PACF빠르게 감소
    - 시차가 5인 지점에서 처음으로 파란선 안에 존재할 때, 바로 전 시차인 4지점까지가 현재 시점에 영향을 미친다고 판단, MA(4) 모형 사용이 적절

3. 자기회귀누적이동평균(ARIMA) 모형

- 비정상 시계열 자료를 다룰 수 있는 모형으로, 현실의 대부분의 시계열 자료를 설명할 수 있다
  - 비정상 시계열이기 때문에, 차분이나 변환을 통해 정상화 할 수 있다. ARIMA(p,d,q)의 이상적인 p,d,q값 찾기
    - p: AR모형의 차수 p=0이면 IMA(d,q) 모형
    - d: 정상화 위한 차분 횟수 d=0이면 ARMA(p,q) 모형 -> 정상성 만족 모형
    - q: MA모형의 차수 q=0이면 ARI(p,d) 모형
- ARIMA(0,1,0) : 정상성 만족을 위해 1회의 차분이 필요한 모형
  - 시차가 1인 지점에서 자기상관, 부분자기상관이 파란선 내 존재 -> 1회차분시 AR(0), MA(0)이 됨 -> 1회 차분하여 정상성을 만족하는 자료는 이전 시점에 영향을 받지 않는 무작위 변동이라고 판단할 수 있음.

## 분해 시계열 - 추 계 순 불

1. 추세요인(Trend): 인구의 증가, 기술의 변화 등과 같은 요인에 의해 장기간 일정 방향으로 상승 또는 하락하는 경향을 보이는 요인, 급격한 충격 없으면 지속되는 특징.
2. 계절요인(Seasonal): 일정한 주기를 가지는 상하반복의 규칙적 변동(주기, 월별, 분기별, 계절별), 주기적으로 유사한 패턴, 예측 상대적으로 쉬움
3. 순환요인(Cyclical): 정확히 알려진 이유 없고 주기가 일정하지 않은 변동, 보통 추세선 따라 상하로 반복운동
4. 불규칙요인(Irregular): 위 세 요인으로 설명하지 못하는 오차에 해당하는 요인, 규칙성 없이 우연히 발생, 천재지변, 질병 등
